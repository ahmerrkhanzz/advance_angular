<div class="panel-body"> <div class="row"> <form name="forms.basicDetailsForm" class="clearfix" novalidate> <div class="col-lg-6 block-basic-details"> <div class="form-group" ng-class="{'has-errors': InstitutionsController.isInvalidNewSchoolName}"> <label>Name *</label> <div ng-if="institution.id"> <input type="text" class="form-control" name="name" ng-model="institution.name" ng-required="true" custom-popover popover-html="Add institution name" popover-placement="left" popover-trigger="manual" popover-visibility="{{InstitutionsController.isInvalidNewSchoolName}}" ng-focus="InstitutionsController.setIsInvalidNewSchoolName(false)"> </div> <div ng-if="!institution.id"> <input type="text" class="form-control" name="name" ng-model="institution.name" ng-required="true" ng-change="InstitutionsController.findSimilar(institution)" ng-model-options="{ debounce: 750 }" custom-popover popover-html="Add institution name" popover-placement="left" popover-trigger="manual" popover-visibility="{{InstitutionsController.isInvalidNewSchoolName}}" ng-focus="InstitutionsController.setIsInvalidNewSchoolName(false)"> <div wave-spinner class="wave-spinner" ng-show="InstitutionsController.similarNames.loading"></div> <div class="similar-names" ng-show="!institution.id && InstitutionsController.similarNames.display"> <small class="m-b block"> <span class="text-muted">Similarly named existing institutions:</span> <span class="text-navy" ng-show="!InstitutionsController.similarNames.results.length">no results</span> </small> <div ng-show="!InstitutionsController.similarNames.loading" class="text-center"> <div ng-repeat="similarInstitution in InstitutionsController.similarNames.results"> <div><a target="_blank" ng-href="/#/profiles/institution-details?coreId={{similarInstitution.coreId}}">{{similarInstitution.name}} {{similarInstitution.active ? '' : '[inactive]'}}</a></div> </div> </div> </div> </div> </div> <div class="form-group" ng-class="{'has-errors': InstitutionsController.isInvalidType}"> <label>Type * </label> <ui-select name="typeId" ng-required="true" ng-disabled="institution.id" ng-model="selectedItem.selectedOptionType" on-select="InstitutionsController.setSelectedOptionType(selectedItem.selectedOptionType)" theme="bootstrap" custom-popover popover-html="Select an option" popover-placement="left" popover-trigger="manual" popover-visibility="{{InstitutionsController.isInvalidType ? true : false}}"> <ui-select-match placeholder="Select an option">{{$select.selected.name}}</ui-select-match> <ui-select-choices position="down" ui-disable-choice="option.disabled" repeat="option in InstitutionsController.typesList | filter:$select.search track by option.uniqueId"> <div ng-bind-html="option.name | highlight: $select.search"></div> </ui-select-choices> <ui-select-no-choice> Not found </ui-select-no-choice> </ui-select> </div> <div class="form-group" ng-show="InstitutionsController.isClientDepartment(institution.typeId)" ng-class="{'has-errors': InstitutionsController.isInvalidBelongsTo}"> <label> Belongs to * </label> <ui-select name="belongsTo" ng-required="InstitutionsController.isClientDepartment(institution.typeId)" ng-model="institution.belongsTo" on-select="InstitutionsController.setIsInvalidBelongsTo(false)" theme="bootstrap" reset-search-input="true" custom-popover popover-html="Select an option" popover-placement="left" popover-trigger="manual" popover-visibility="{{InstitutionsController.isInvalidBelongsTo ? true : false}}"> <ui-select-match placeholder="Select an option">{{$select.selected.title}}</ui-select-match> <ui-select-choices position="down" repeat="option.id as option in InstitutionsController.belongsToList | filter:$select.search"> <div ng-bind-html="option.title | highlight: $select.search"></div> </ui-select-choices> <ui-select-no-choice> Not found </ui-select-no-choice> </ui-select> </div> <div class="form-group"> <switch class="green" ng-model="institution.businessSchool" ng-disabled="InstitutionsController.isSimpleDepartment(institution.typeId)"></switch> Business School </div> <div class="form-group"> <switch class="green" name="hasNoDepartments" ng-model="institution.hasNoDepartments" ng-disabled="InstitutionsController.isClientDepartment(institution.typeId) || InstitutionsController.isSimpleDepartment(institution.typeId)"></switch> Has No Departments </div> </div> <div class="col-lg-6 block-contact-types"> <div class="form-group"> <label>Local Name</label> <input type="text" class="form-control" ng-model="institution.localName" name="localName"> </div> <div class="form-group force-width-100" ng-show="InstitutionsController.showParentInstitution(institution.typeId)" ng-class="{'has-errors': InstitutionsController.isInvalidParentInstitution}"> <label>Parent institution *</label> <input type="text" class="form-control" ng-model="institution.parentName" ng-show="institution.id" disabled> <div class="search-institutions" ng-show="!institution.id"> <ui-select close-on-select="true" ng-model="institution.parent" on-select="InstitutionsController.handleSearchInstitutionClick($item)" theme="bootstrap" name="parentInstitution" reset-search-input="true" custom-popover popover-html="Type parent institution name" popover-placement="left" popover-trigger="manual" popover-visibility="{{InstitutionsController.isInvalidParentInstitution}}" ng-click="InstitutionsController.setIsInvalidParentInstitution(false)"> <ui-select-match placeholder="Type parent institution name...">{{$select.selected.name}}</ui-select-match> <ui-select-choices refresh-delay="1000" refresh="searchTopLevelInstitutions($select.search)" position="down" repeat="option in parentInstitutionSearchResults | filter:$select.search"> <div ng-bind-html="option.name | highlight: $select.search"></div> </ui-select-choices> <ui-select-no-choice> Not found </ui-select-no-choice> </ui-select> <div class="show-departments mt-5px" ng-show="institution.parentCoreId"> <div class="row"> <div class="col-lg-12"> <div class="ibox-tools"> <button class="btn btn-default btn-xs" ng-show="!InstitutionsController.showDepartments.display" ng-click="InstitutionsController.showDepartments()">Show All Departments</button> <a class="close-link" ng-show="InstitutionsController.showDepartments.display" ng-click="InstitutionsController.handleDepartmentsListCloseClick()"> <i class="fa fa-times"></i> </a> <div class="pull-left" ng-show="!InstitutionsController.showDepartments.loading && InstitutionsController.showDepartments.display"> <small class="m-b block"> <span class="text-muted">Current Client departments:</span> <span class="text-navy" ng-show="!InstitutionsController.showDepartments.results.length">no results</span> </small> </div> </div> </div> </div> <div class="row"> <div class="col-lg-12 text-center"> <div wave-spinner class="wave-spinner" ng-show="InstitutionsController.showDepartments.loading"></div> <div ng-show="InstitutionsController.showDepartments.display && InstitutionsController.showDepartments.results.length"> <div ng-repeat="clientDeparmtent in InstitutionsController.showDepartments.results"> <div> <a target="_blank" ng-href="/#/profiles/institution-details?coreId={{clientDeparmtent.coreId}}">{{clientDeparmtent.name}}</a> </div> </div> </div> </div> </div> </div> </div> </div> <div class="form-group"> <label>FileMaker ID</label> <input type="text" class="form-control" ng-model="institution.filemakerId" name="filemakerId"> </div> <div class="form-group" ng-class="{'has-errors': InstitutionsController.isInvalidCountry}"> <label>Country *</label> <ui-select id="campusCountry" name="countryCode" ng-model="institution.countryCode" on-select="updateCountryName()" ng-required="true" theme="bootstrap" custom-popover popover-html="Select an option" popover-placement="left" popover-trigger="manual" popover-visibility="{{InstitutionsController.isInvalidCountry ? true : false}}"> <ui-select-match placeholder="Select an option">{{$select.selected.name}}</ui-select-match> <ui-select-choices position="auto" ui-disable-choice="option.disabled" repeat="option.countryCode as option in InstitutionsController.countriesList | filter:$select.search"> <div ng-bind-html="option.name | highlight: $select.search"></div> </ui-select-choices> <ui-select-no-choice> Not found </ui-select-no-choice> </ui-select> </div> <button class="btn btn-primary btn-sm btn-block" ng-disabled="basicDetailsSubmitInProgress" ng-click="handleBasicDetailsSubmit()">{{institution.id ? 'Update' : 'Save'}}</button> </div> </form> </div> </div>